@model MediClinic.Models.Appointment

@{
    ViewData["Title"] = "Assign Doctor";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@if (!ViewData.ModelState.IsValid)
{
    <script>
        window.onload = function () {
            alert("Doctor already booked for this time.");
        };
    </script>
}

<div class="admin-form-wrapper">
    <div class="admin-form-card">

        <h4 class="form-title text-center mb-4">Assign Doctor</h4>

        <form asp-action="AssignDoctorPost" method="post">

            <!-- Hidden Appointment ID -->
            <input type="hidden"
                   name="AppointmentID"
                   value="@Model.AppointmentId" />

            <!-- Patient Name -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Patient Name</label>
                <input type="text"
                       value="@Model.Patient.PatientName"
                       class="form-control"
                       readonly />
            </div>

            <!-- Criticality -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Criticality</label>
                <input type="text"
                       value="@Model.Criticality"
                       class="form-control"
                       readonly />
            </div>

            <!-- Reason -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Reason</label>
                <input type="text"
                       value="@Model.Reason"
                       class="form-control"
                       readonly />
            </div>

            <!-- Select Doctor -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Select Doctor</label>
                <select name="PhysicianID"
                        asp-items="ViewBag.Physicians"
                        class="form-select"
                        required>
                    <option value="">-- Select Doctor --</option>
                </select>
            </div>

            <!-- Schedule Date -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Date</label>
                <input type="date"
                       name="ScheduleDate"
                       class="form-control"
                       value="@Model.AppointmentDate?.ToString("yyyy-MM-dd")"
                       required />
            </div>

            <!-- Schedule Time -->
            <div class="mb-4">
                <label class="form-label fw-semibold">Time</label>
                <input type="time"
                       name="ScheduleTime"
                       class="form-control"
                       value="@Model.AppointmentDate?.ToString("HH:mm")"
                       required />
            </div>

            <!-- Buttons -->
            <div class="d-flex justify-content-between">
                <a asp-action="PendingAppointments"
                   class="btn btn-secondary">
                    Back
                </a>

                <button type="submit"
                        class="btn btn-success px-4">
                    Assign
                </button>
            </div>

        </form>

    </div>
</div>